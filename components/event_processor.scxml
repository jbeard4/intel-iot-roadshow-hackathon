  <datamodel>
    <data id="dot_duration" expr="250"/>
  </datamodel>
  <state id="released">
    <state id="initial">
      <onentry>
        <send id="short_pause_timeout" event="short_pause_timeout" delayexpr="dot_duration * 3 + 'ms'"/>
      </onentry>
      <onexit>
        <cancel sendid="short_pause_timeout"/>
      </onexit>
      <transition event="short_pause_timeout" target="short_pause">
      </transition>
      <transition event="device.press" target="pressed">
      </transition>
    </state> 
    <state id="short_pause">
      <onentry>
        <send id="long_pause_timeout" event="long_pause_timeout" delayexpr="dot_duration * 4 + 'ms'"/>
        <send event="short_pause"/> 
      </onentry>
      <onexit>
        <cancel sendid="long_pause_timeout"/>
      </onexit>
      <transition event="long_pause_timeout" target="long_pause"/>
      <transition event="device.press" target="pressed"/>
    </state> 
    <state id="long_pause">
      <onentry>
        <send event="long_pause"/> 
      </onentry>
      <transition event="device.press" target="pressed"></transition>
    </state> 
  </state>
  <state id="pressed">
    <state id="sending_dot">
      <onentry>
        <send id="dash-timeout" event="dash-timeout" delayexpr="dot_duration * 3 + 'ms'"/>
      </onentry>
      <onexit>
        <cancel sendid="dash-timeout"/>
      </onexit>
      <transition event="dash-timeout" target="sending_dash"/>
      <transition event="device.release" target="released">
        <send event="dot"/> 
      </transition>
    </state>
    <state id="sending_dash">
      <transition event="device.release" target="released">
        <send event="dash"/> 
      </transition>
    </state>
  </state> 
